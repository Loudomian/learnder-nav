import{s as h}from"./service-CvN87575.js";import{_ as u,G as l,r as d,o as s,c as m,w as f,a as p,b as i,t as n,e as r}from"./index-DwBrLgem.js";const g={name:"Immich",components:{Generic:l},mixins:[h],props:{item:Object},data:()=>({users:null,photos:null,videos:null,usage:null,serverError:!1}),computed:{humanizeSize:function(){let e=this.usage;if(Math.abs(e)<1024)return e+" B";const t=["KiB","MiB","GiB","TiB"];let o=-1;do e/=1024,++o;while(Math.round(Math.abs(e)*100)/100>=1024&&o<t.length-1);return e.toFixed(2)+" "+t[o]}},created:function(){const e=parseInt(this.item.updateInterval,10)||0;e>0&&setInterval(()=>this.fetchConfig(),e),this.fetchConfig()},methods:{fetchConfig:function(){const e={"x-api-key":this.item.apikey};this.fetch("/api/server/statistics",{headers:e}).then(t=>{this.photos=t.photos,this.videos=t.videos,this.usage=t.usage,this.users=t.usageByUser.length}).catch(t=>{console.error(t),this.serverError=!0})}}},_={class:"notifs"},v={key:0,class:"notif users",title:"Users"},y={key:1,class:"notif photos",title:"Photos"},k={key:2,class:"notif videos",title:"Videos"},B={key:3,class:"notif usage",title:"Usage"},I={key:4,class:"notif errors",title:"Connection error to Immich API, check your url and apikey in config.yml"};function C(e,t,o,b,G,a){const c=d("Generic");return s(),m(c,{item:o.item},{indicator:f(()=>[p("div",_,[e.users>0?(s(),i("strong",v,n(e.users),1)):r("",!0),e.photos>0?(s(),i("strong",y,n(e.photos),1)):r("",!0),e.videos>0?(s(),i("strong",k,n(e.videos),1)):r("",!0),e.usage>0?(s(),i("strong",B,n(a.humanizeSize),1)):r("",!0),e.serverError?(s(),i("strong",I,"?")):r("",!0)])]),_:1},8,["item"])}const M=u(g,[["render",C],["__scopeId","data-v-e0e03d3c"]]);export{M as default};
