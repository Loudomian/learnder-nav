import{s as c}from"./service-CvN87575.js";import{_ as h,G as u,r as p,o as r,c as d,w as l,a as f,b as n,t as i,e as o}from"./index-DwBrLgem.js";const m={name:"FreshRSS",components:{Generic:u},mixins:[c],props:{item:Object},data:()=>({subscriptions:0,unread:0,serverError:!1}),created:function(){const e=parseInt(this.item.updateInterval,10)||0;e>0&&setInterval(()=>this.fetchConfig(),e),this.fetchConfig()},methods:{fetchConfig:async function(){if(!this.auth){const t=await this.fetch(`/api/greader.php/accounts/ClientLogin?Email=${this.item.username}&Passwd=${this.item.password}`,{method:"GET",cache:"no-cache"},!1).then(s=>s.text()).then(s=>s.match(/Auth=(([([a-z0-9]+)\/([([a-z0-9]+))/i));t!==null&&(this.auth=t[1])}const e={Authorization:`GoogleLogin auth=${this.auth}`};this.fetch("/api/greader.php/reader/api/0/subscription/list?output=json",{headers:e}).then(t=>{this.subscriptions=t.subscriptions.length}).catch(t=>{console.error(t),this.serverError=!0}),this.fetch("/api/greader.php/reader/api/0/unread-count?output=json",{headers:e}).then(t=>{this.unread=t.max}).catch(t=>{console.error(t),this.serverError=!0})}}},_={class:"notifs"},g={key:0,class:"notif subscriptions",title:"Subscriptions"},v={key:1,class:"notif unread",title:"Unread"},b={key:2,class:"notif errors",title:"Connection error to the FreshRSS API, check url username and password in config.yml"};function C(e,t,s,S,k,E){const a=p("Generic");return r(),d(a,{item:s.item},{indicator:l(()=>[f("div",_,[e.subscriptions>0?(r(),n("strong",g,i(e.subscriptions),1)):o("",!0),e.unread>0?(r(),n("strong",v,i(e.unread),1)):o("",!0),e.serverError?(r(),n("strong",b,"?")):o("",!0)])]),_:1},8,["item"])}const G=h(m,[["render",C],["__scopeId","data-v-06f8a296"]]);export{G as default};
