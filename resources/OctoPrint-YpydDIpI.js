import{s as g}from"./service-CvN87575.js";import{_ as k,G as T,r as b,o as r,c as S,w as h,a as n,t as l,b as s,F as p,d as y,e as i,n as $}from"./index-DwBrLgem.js";const C={name:"OctoPrint",components:{Generic:T},mixins:[g],props:{item:Object},data:()=>({printTime:null,printTimeLeft:null,completion:null,state:null,printer:null,error:null}),computed:{statusClass:function(){switch(this.state){case"Operational":return"ready";case"Offline":return"offline";case"Printing":return"in-progress";default:return"pending"}}},created(){this.display=this.item.display=="bar"?this.item.display:"text",this.fetchPrinterStatus(),this.fetchStatus()},methods:{fetchStatus:async function(){try{const t=await this.fetch(`api/job?apikey=${this.item.apikey}`);this.printTime=t.progress.printTime,this.printTimeLeft=t.progress.printTimeLeft,this.completion=t.progress.completion,this.state=t.state,this.error=t.error}catch(t){this.error=`Fail to fetch octoprint data (${t.message})`,console.error(t)}},fetchPrinterStatus:async function(){try{const t=await this.fetch(`api/printer?apikey=${this.item.apikey}`);this.printer=t,this.error=t.error}catch(t){this.error=`Fail to fetch octoprint data (${t.message})`,console.error(t)}},formatTime:function(t){const e=Math.floor(t/86400);let a=t%86400;const u=Math.floor(a/3600);a%=3600;const d=Math.floor(a/60),o=a%60,m=u.toString().padStart(2,"0"),c=d.toString().padStart(2,"0"),f=o.toString().padStart(2,"0");return e>0?`${e}d ${m}h ${c}m`:u>0?`${m}h ${c}m ${f}s`:d>0?`${c}m ${f}s`:`${o} seconds`}}},F={class:"title is-4"},w={class:"subtitle is-6"},v={key:0},L=["title"],O={key:0},P={key:1},B=["value","title"],G=["title"],M=["title"];function N(t,e,a,u,d,o){const m=b("Generic");return r(),S(m,{item:a.item,title:t.state},{content:h(()=>[n("p",F,l(a.item.name),1),n("p",w,[a.item.subtitle&&!t.state?(r(),s(p,{key:0},[y(l(a.item.subtitle),1)],64)):i("",!0),!t.error&&t.display=="text"&&o.statusClass=="in-progress"?(r(),s(p,{key:1},[e[1]||(e[1]=n("i",{class:"fa-solid fa-gear mr-1"},null,-1)),t.completion?(r(),s("b",v,l(t.completion.toFixed())+"%",1)):i("",!0),e[2]||(e[2]=n("span",{class:"separator mx-1"}," | ",-1)),t.printTime?(r(),s("span",{key:1,title:`${o.formatTime(t.printTimeLeft)} left`},[e[0]||(e[0]=n("i",{class:"fa-solid fa-stopwatch mr-1"},null,-1)),y(" "+l(o.formatTime(t.printTime)),1)],8,L)):i("",!0)],64)):i("",!0),!t.error&&t.display=="text"&&o.statusClass=="ready"?(r(),s(p,{key:2},[e[3]||(e[3]=n("i",{class:"fa-solid fa-temperature-half mr-1"},null,-1)),t.printer.temperature.bed?(r(),s("b",O,l(t.printer.temperature.bed.actual.toFixed())+" C",1)):i("",!0),e[4]||(e[4]=n("span",{class:"separator mx-1"}," | ",-1)),t.printer.temperature.tool0?(r(),s("b",P,l(t.printer.temperature.tool0.actual.toFixed())+" C",1)):i("",!0)],64)):i("",!0),!t.error&&t.display=="bar"?(r(),s(p,{key:3},[t.completion?(r(),s("progress",{key:0,class:"progress is-primary",value:t.completion,max:"100",title:`${t.state} - ${t.completion.toFixed()}%, ${o.formatTime(t.printTimeLeft)} left`},l(t.completion)+"% ",9,B)):i("",!0)],64)):i("",!0),t.error?(r(),s("span",{key:4,title:t.error},l(t.error),9,G)):i("",!0)])]),indicator:h(()=>[n("i",{class:$(["status",o.statusClass]),title:t.state},null,10,M)]),_:1},8,["item","title"])}const z=k(C,[["render",N],["__scopeId","data-v-787256dd"]]);export{z as default};
